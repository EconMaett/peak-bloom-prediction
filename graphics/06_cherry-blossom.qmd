---
title: "Sakura Surprise: Cherry blossoms in Kyoto blooming earlier in the past ~100 years!"
format: 
  html:
    theme: darkly
    code-fold: show
editor: source
---

Original blog post: <https://ryo-n7.github.io/2018-04-02-sakura-surprise/>.

**April** in *Japan* is a time of new beginnings. Unlike most countries, the school year starts in April and is also the beginning of the fiscal year for the government and most corporations. This past April, The Economist presented an interesting article with a beautiful graphic depicting the steadily earlier blossoming of **"sakura" or "cherry blossom"** trees in Kyoto.

In this article, we try to recreate this graphic with some tricks. The data set can be downloaded from [here](http://atmenv.envi.osakafu-u.ac.jp/aono/kyophenotemp4/).

## Load packages

```{r}
#| label: laod-pkgs
#| output: false

rm(list = ls(all.names = TRUE))

library(tidyverse)

file_kyoto  <- "data/date-of-the-peak-cherry-tree-blossom-in-kyoto.csv"
icon_sakura <- "images/blossom.png"

invisible(Sys.setlocale("LC_TIME", "en_GB.UTF-8"))

sakura <- read_csv(file_kyoto)|> 
  set_names(nm = c("entity", "code", "year", "20ma", "doy")) |> 
  mutate(date = as.Date(doy, origin = "853-01-01")) 

head(sakura)
```

Looking at the data, it appears that data is missing from a number of rows until **812 AD**, along with many other rows throughout the years.

We might as well cut those rows out since we can manually specify the limits of our `year` variable when we start plotting. Let's remove a few columns that we won't be needing for our analysis.

```{r}
#| label: plot-cherry-blossom
#| warning: false

myplot <- ggplot(data = sakura, mapping = aes(x = year, y = doy)) +
  geom_point(shape = 8, size = 5, colour = "pink") +
  geom_smooth(span = 0.2, linewidth = 2.5, colour = "#dd1c77", fill = "red") +
  scale_y_continuous(labels = function(x) { format(as.Date(as.character(x), "%j"), "%d-%b") }) +
  scale_x_continuous(limits = c(800, 2020), breaks = seq(from = 800, to = 2000, by = 200)) +
  labs(
    title = "Sakura Surprise!",
    subtitle = "Date of peak sakura blossoming in Kyoto, Japan (800-2021)",
    x = "Year", y = "Date of peak sakura bloom"
  ) +
  theme_bw(base_family = "Roboto condensed", base_size = 14) +
  theme(
    axis.text.x = element_text(size = 14, angle = 45, hjust = 1),
    axis.text.y = element_text(size = 12)
  )

print(myplot)
```

Save the plot

```{r}
#| label: save-plot
#| output: false

ggsave("images/cherry_blossom_03.png", width = 25, height = 18, units = "cm", dpi = 300)
```
