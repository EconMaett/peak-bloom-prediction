---
title: "Kyoto Cherry Blossom Peak Raises Climate Change Concerns"
format: 
  html:
    theme: darkly
    code-fold: show
editor: source
---

Original Statista post: <https://www.statista.com/chart/24545/kyoto-cherry-blossom-bloom-peak/#:~:text=Before%20the%2020th%20century%2C%20bloom,day%20later%20than%20this%20year.>.

The bloom of cherry trees in Kyoto reached its peak on Friday, March 26, the earliest date ever seen in almost 1,200 years of records that exist on the occasion which has been attracting scores of tourists to Japan almost for as long. The records which go back to the 9th century have been [published by a researcher at Osaka Prefecture University](http://atmenv.envi.osakafu-u.ac.jp/aono/kyophenotemp4/).

Warmer temperatures caused by climate change are suspected to bring about earlier bloom dates, the [Washington Post reports](https://www.washingtonpost.com/weather/2021/03/29/japan-kyoto-cherry-blossoms-record/). As with all climate-related data, lots of variation exists between years but a clear trend is towards an earlier bloom is visible in the raw data as well as in the 20-year rolling average. Before the 20th century, bloom dates had varied but rarely fallen below the mark of 90 days into the new year. The earliest date previous to 2021 had occurred in 1409 when peak bloom happened at 86 days into the year (March 27), one day later than this year.

Theresa Crimmins, director of the USA National Phenology Network, told the Washington Post that earlier bloom dates had disadvantages for fruit trees, like raising the danger of losing flower buds to frost in more volatile spring climates or risking having too few insects around as pollinators.

## Load packages

```{r}
#| label: load-pkgs
#| output: false

library(tidyverse)

invisible(Sys.setlocale("LC_TIME", "en_GB.UTF-8"))
```

## Load data

```{r}
#| label: load-data

df <- read_rds(file = "data/kyoto.rds") |> 
  rename(year = ad) |> 
  select(year, full_flowering_date, full_flowering_date_doy) |> 
  mutate(ma20 = slider::slide_dbl(.x = full_flowering_date_doy, .f = mean, .before = 20, .complete = TRUE))
```

## Plot the data

Plot the data

```{r}
#| label: plot-data
#| warning: false

myplot <- ggplot(data = df, mapping = aes(x = year)) +
  geom_rect(mapping = aes(xmin = 812, xmax = 2030, ymin = 60, ymax = 90), fill = "#cad5ec", alpha = 0.03) +
  geom_rect(mapping = aes(xmin = 812, xmax = 2030, ymin = 90, ymax = 120), fill = "#b9e0c9", alpha = 0.05) +
  geom_rect(mapping = aes(xmin = 812, xmax = 2030, ymin = 120, ymax = 140), fill = "#e0d4b1", alpha = 0.02) +
  geom_line(mapping = aes(y = full_flowering_date_doy, colour = "full_flowering_date_doy"), linewidth = 0.75) +
  geom_point(mapping = aes(y = full_flowering_date_doy), colour = "darkred", size = 1.1) +
  geom_line(mapping = aes(y = ma20, colour = "ma20"), linewidth = 1) +
  scale_color_manual(
    breaks = c("full_flowering_date_doy", "ma20"), 
    values = c("pink2", "darkblue"), 
    labels = c("Days into year", "20-year left-aligned moving average"), 
    name = ""
  ) +
  scale_x_continuous(limits = c(812, 2030), breaks = c(812, 1000, 1500, 2000), expand = c(0, 0)) +
  scale_y_continuous(limits = c(60, 140), breaks = seq(from = 60, to = 140, by = 20), expand = c(0, 0)) +
  labs(
    title = "Kyoto Cherry Blossom Peak Raises Climate Change Concerns",
    subtitle = "Peak of cherry blossom boom in Kyoto and 20-year left-aligned moving average (812-2021)",
    x = NULL, y = NULL,
    caption = "Source: Yasuyuki Aono/Osaka Prefecture University"
  ) +
  annotate("text", x = 825, y = 75, label = "March", size = 4, angle = 90) +
  annotate("text", x = 825, y = 105, label = "April", size = 4, angle = 90) +
  annotate("text", x = 825, y = 130, label = "May", size = 4, angle = 90) +
  guides(colour = guide_legend(nrow = 1)) +
  theme(
    panel.background = element_rect(fill = "#ffffff"),
    panel.grid.major.y = element_line(colour = "#a56c56", linetype = "solid"),
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    panel.spacing = unit(0.1, units = "cm"),
    axis.line.x = element_line(color = "black"),
    axis.line.y = element_blank(),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 10),
    legend.position = c(0.3, 0.95),
    legend.key = element_blank(),
    legend.box = "horizontal",
    legend.box.spacing = unit(1, units = "mm"),
    legend.title = element_blank(),
    legend.text = element_text(size = 10, family = "Roboto Condensed", face = "plain"),
    legend.background = element_blank(),
    plot.title = element_text(hjust = 0, face = "bold", size = 16, colour = "black"),
    plot.subtitle = element_text(hjust = 0, face = "bold", size = 14, colour = "darkgrey"),
    plot.caption = element_text(hjust = 0, size = 8, colour = "#b3b1b1"),
    strip.placement = "outside",
    strip.background = element_rect(fill = "#e8dbd6"),
    strip.switch.pad.grid = unit(0.2, units = "cm"),
    strip.text = element_text(size = 10)
  )

print(myplot)
```

## Save plot

Save the plot

```{r}
#| label: save-plot
#| output: false

ggsave("images/statista-cherry.png", width = 25, height = 18, units = "cm", dpi = 350)
```
